var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}var tagify_min={exports:{}};(function(module,exports){(function(t,e){module.exports=e()})(commonjsGlobal,function(){function t(t2,e2){var i2=Object.keys(t2);if(Object.getOwnPropertySymbols){var s2=Object.getOwnPropertySymbols(t2);e2&&(s2=s2.filter(function(e3){return Object.getOwnPropertyDescriptor(t2,e3).enumerable})),i2.push.apply(i2,s2)}return i2}function e(e2){for(var s2=1;s2<arguments.length;s2++){var a2=arguments[s2]!=null?arguments[s2]:{};s2%2?t(Object(a2),!0).forEach(function(t2){i(e2,t2,a2[t2])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e2,Object.getOwnPropertyDescriptors(a2)):t(Object(a2)).forEach(function(t2){Object.defineProperty(e2,t2,Object.getOwnPropertyDescriptor(a2,t2))})}return e2}function i(t2,e2,i2){return(e2=function(t3){var e3=function(t4,e4){if(typeof t4!="object"||t4===null)return t4;var i3=t4[Symbol.toPrimitive];if(i3!==void 0){var s2=i3.call(t4,e4||"default");if(typeof s2!="object")return s2;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e4==="string"?String:Number)(t4)}(t3,"string");return typeof e3=="symbol"?e3:String(e3)}(e2))in t2?Object.defineProperty(t2,e2,{value:i2,enumerable:!0,configurable:!0,writable:!0}):t2[e2]=i2,t2}const s=(t2,e2,i2,s2)=>(t2=""+t2,e2=""+e2,s2&&(t2=t2.trim(),e2=e2.trim()),i2?t2==e2:t2.toLowerCase()==e2.toLowerCase()),a=(t2,e2)=>t2&&Array.isArray(t2)&&t2.map(t3=>n(t3,e2));function n(t2,e2){var i2,s2={};for(i2 in t2)e2.indexOf(i2)<0&&(s2[i2]=t2[i2]);return s2}function o(t2){var e2=document.createElement("div");return t2.replace(/\&#?[0-9a-z]+;/gi,function(t3){return e2.innerHTML=t3,e2.innerText})}function r(t2){return new DOMParser().parseFromString(t2.trim(),"text/html").body.firstElementChild}function l(t2,e2){for(e2=e2||"previous";t2=t2[e2+"Sibling"];)if(t2.nodeType==3)return t2}function d(t2){return typeof t2=="string"?t2.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/`|'/g,"&#039;"):t2}function h(t2){var e2=Object.prototype.toString.call(t2).split(" ")[1].slice(0,-1);return t2===Object(t2)&&e2!="Array"&&e2!="Function"&&e2!="RegExp"&&e2!="HTMLUnknownElement"}function g(t2,e2,i2){function s2(t3,e3){for(var i3 in e3)if(e3.hasOwnProperty(i3)){if(h(e3[i3])){h(t3[i3])?s2(t3[i3],e3[i3]):t3[i3]=Object.assign({},e3[i3]);continue}if(Array.isArray(e3[i3])){t3[i3]=Object.assign([],e3[i3]);continue}t3[i3]=e3[i3]}}return t2 instanceof Object||(t2={}),s2(t2,e2),i2&&s2(t2,i2),t2}function p(){const t2=[],e2={};for(let i2 of arguments)for(let s2 of i2)h(s2)?e2[s2.value]||(t2.push(s2),e2[s2.value]=1):t2.includes(s2)||t2.push(s2);return t2}function c(t2){return String.prototype.normalize?typeof t2=="string"?t2.normalize("NFD").replace(/[\u0300-\u036f]/g,""):void 0:t2}var u=()=>/(?=.*chrome)(?=.*android)/i.test(navigator.userAgent);function m(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t2=>(t2^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t2/4).toString(16))}function v(t2){return t2&&t2.classList&&t2.classList.contains(this.settings.classNames.tag)}function f(t2,e2){var i2=window.getSelection();return e2=e2||i2.getRangeAt(0),typeof t2=="string"&&(t2=document.createTextNode(t2)),e2&&(e2.deleteContents(),e2.insertNode(t2)),t2}function T(t2,e2,i2){return t2?(e2&&(t2.__tagifyTagData=i2?e2:g({},t2.__tagifyTagData||{},e2)),t2.__tagifyTagData):(console.warn("tag element doesn't exist",t2,e2),e2)}var w={delimiters:",",pattern:null,tagTextProp:"value",maxTags:1/0,callbacks:{},addTagOnBlur:!0,onChangeAfterBlur:!0,duplicates:!1,whitelist:[],blacklist:[],enforceWhitelist:!1,userInput:!0,keepInvalidTags:!1,createInvalidTags:!0,mixTagsAllowedAfter:/,|\.|\:|\s/,mixTagsInterpolator:["[[","]]"],backspace:!0,skipInvalid:!1,pasteAsTags:!0,editTags:{clicks:2,keepInvalid:!0},transformTag:()=>{},trim:!0,a11y:{focusableTags:!1},mixMode:{insertAfterTag:"Â "},autoComplete:{enabled:!0,rightKey:!1},classNames:{namespace:"tagify",mixMode:"tagify--mix",selectMode:"tagify--select",input:"tagify__input",focus:"tagify--focus",tagNoAnimation:"tagify--noAnim",tagInvalid:"tagify--invalid",tagNotAllowed:"tagify--notAllowed",scopeLoading:"tagify--loading",hasMaxTags:"tagify--hasMaxTags",hasNoTags:"tagify--noTags",empty:"tagify--empty",inputInvalid:"tagify__input--invalid",dropdown:"tagify__dropdown",dropdownWrapper:"tagify__dropdown__wrapper",dropdownHeader:"tagify__dropdown__header",dropdownFooter:"tagify__dropdown__footer",dropdownItem:"tagify__dropdown__item",dropdownItemActive:"tagify__dropdown__item--active",dropdownItemHidden:"tagify__dropdown__item--hidden",dropdownInital:"tagify__dropdown--initial",tag:"tagify__tag",tagText:"tagify__tag-text",tagX:"tagify__tag__removeBtn",tagLoading:"tagify__tag--loading",tagEditing:"tagify__tag--editable",tagFlash:"tagify__tag--flash",tagHide:"tagify__tag--hide"},dropdown:{classname:"",enabled:2,maxItems:10,searchKeys:["value","searchBy"],fuzzySearch:!0,caseSensitive:!1,accentedSearch:!0,includeSelectedTags:!1,highlightFirst:!1,closeOnSelect:!0,clearOnSelect:!0,position:"all",appendTarget:null},hooks:{beforeRemoveTag:()=>Promise.resolve(),beforePaste:()=>Promise.resolve(),suggestionClick:()=>Promise.resolve()}};function b(){this.dropdown={};for(let t2 in this._dropdown)this.dropdown[t2]=typeof this._dropdown[t2]=="function"?this._dropdown[t2].bind(this):this._dropdown[t2];this.dropdown.refs()}var y={refs(){this.DOM.dropdown=this.parseTemplate("dropdown",[this.settings]),this.DOM.dropdown.content=this.DOM.dropdown.querySelector("[data-selector='tagify-suggestions-wrapper']")},getHeaderRef(){return this.DOM.dropdown.querySelector("[data-selector='tagify-suggestions-header']")},getFooterRef(){return this.DOM.dropdown.querySelector("[data-selector='tagify-suggestions-footer']")},getAllSuggestionsRefs(){return[...this.DOM.dropdown.content.querySelectorAll(this.settings.classNames.dropdownItemSelector)]},show(t2){var e2,i2,a2,n2=this.settings,o2=n2.mode=="mix"&&!n2.enforceWhitelist,r2=!n2.whitelist||!n2.whitelist.length,l2=n2.dropdown.position=="manual";if(t2=t2===void 0?this.state.inputText:t2,!(r2&&!o2&&!n2.templates.dropdownItemNoMatch||n2.dropdown.enable===!1||this.state.isLoading||this.settings.readonly)){if(clearTimeout(this.dropdownHide__bindEventsTimeout),this.suggestedListItems=this.dropdown.filterListItems(t2),t2&&!this.suggestedListItems.length&&(this.trigger("dropdown:noMatch",t2),n2.templates.dropdownItemNoMatch&&(a2=n2.templates.dropdownItemNoMatch.call(this,{value:t2}))),!a2){if(this.suggestedListItems.length)t2&&o2&&!this.state.editing.scope&&!s(this.suggestedListItems[0].value,t2)&&this.suggestedListItems.unshift({value:t2});else{if(!t2||!o2||this.state.editing.scope)return this.input.autocomplete.suggest.call(this),void this.dropdown.hide();this.suggestedListItems=[{value:t2}]}i2=""+(h(e2=this.suggestedListItems[0])?e2.value:e2),n2.autoComplete&&i2&&i2.indexOf(t2)==0&&this.input.autocomplete.suggest.call(this,e2)}this.dropdown.fill(a2),n2.dropdown.highlightFirst&&this.dropdown.highlightOption(this.DOM.dropdown.content.querySelector(n2.classNames.dropdownItemSelector)),this.state.dropdown.visible||setTimeout(this.dropdown.events.binding.bind(this)),this.state.dropdown.visible=t2||!0,this.state.dropdown.query=t2,this.setStateSelection(),l2||setTimeout(()=>{this.dropdown.position(),this.dropdown.render()}),setTimeout(()=>{this.trigger("dropdown:show",this.DOM.dropdown)})}},hide(t2){var e2=this.DOM,i2=e2.scope,s2=e2.dropdown,a2=this.settings.dropdown.position=="manual"&&!t2;if(s2&&document.body.contains(s2)&&!a2)return window.removeEventListener("resize",this.dropdown.position),this.dropdown.events.binding.call(this,!1),i2.setAttribute("aria-expanded",!1),s2.parentNode.removeChild(s2),setTimeout(()=>{this.state.dropdown.visible=!1},100),this.state.dropdown.query=this.state.ddItemData=this.state.ddItemElm=this.state.selection=null,this.state.tag&&this.state.tag.value.length&&(this.state.flaggedTags[this.state.tag.baseOffset]=this.state.tag),this.trigger("dropdown:hide",s2),this},toggle(t2){this.dropdown[this.state.dropdown.visible&&!t2?"hide":"show"]()},render(){var t2,e2,i2,s2=(t2=this.DOM.dropdown,(i2=t2.cloneNode(!0)).style.cssText="position:fixed; top:-9999px; opacity:0",document.body.appendChild(i2),e2=i2.clientHeight,i2.parentNode.removeChild(i2),e2),a2=this.settings;return typeof a2.dropdown.enabled=="number"&&a2.dropdown.enabled>=0?(this.DOM.scope.setAttribute("aria-expanded",!0),document.body.contains(this.DOM.dropdown)||(this.DOM.dropdown.classList.add(a2.classNames.dropdownInital),this.dropdown.position(s2),a2.dropdown.appendTarget.appendChild(this.DOM.dropdown),setTimeout(()=>this.DOM.dropdown.classList.remove(a2.classNames.dropdownInital))),this):this},fill(t2){t2=typeof t2=="string"?t2:this.dropdown.createListHTML(t2||this.suggestedListItems);var e2,i2=this.settings.templates.dropdownContent.call(this,t2);this.DOM.dropdown.content.innerHTML=(e2=i2)?e2.replace(/\>[\r\n ]+\</g,"><").replace(/(<.*?>)|\s+/g,(t3,e3)=>e3||" "):""},fillHeaderFooter(){var t2=this.dropdown.filterListItems(this.state.dropdown.query),e2=this.parseTemplate("dropdownHeader",[t2]),i2=this.parseTemplate("dropdownFooter",[t2]),s2=this.dropdown.getHeaderRef(),a2=this.dropdown.getFooterRef();e2&&(s2==null||s2.parentNode.replaceChild(e2,s2)),i2&&(a2==null||a2.parentNode.replaceChild(i2,a2))},refilter(t2){t2=t2||this.state.dropdown.query||"",this.suggestedListItems=this.dropdown.filterListItems(t2),this.dropdown.fill(),this.suggestedListItems.length||this.dropdown.hide(),this.trigger("dropdown:updated",this.DOM.dropdown)},position(t2){var e2=this.settings.dropdown;if(e2.position!="manual"){var i2,s2,a2,n2,o2,r2,l2=this.DOM.dropdown,d2=e2.placeAbove,h2=e2.appendTarget===document.body,g2=h2?window.pageYOffset:e2.appendTarget.scrollTop,p2=document.fullscreenElement||document.webkitFullscreenElement||document.documentElement,c2=p2.clientHeight,u2=Math.max(p2.clientWidth||0,window.innerWidth||0)>480?e2.position:"all",m2=this.DOM[u2=="input"?"input":"scope"];if(t2=t2||l2.clientHeight,this.state.dropdown.visible){if(u2=="text"?(a2=(i2=function(){const t3=document.getSelection();if(t3.rangeCount){const e3=t3.getRangeAt(0),i3=e3.startContainer,s3=e3.startOffset;let a3,n3;if(s3>0)return n3=document.createRange(),n3.setStart(i3,s3-1),n3.setEnd(i3,s3),a3=n3.getBoundingClientRect(),{left:a3.right,top:a3.top,bottom:a3.bottom};if(i3.getBoundingClientRect)return i3.getBoundingClientRect()}return{left:-9999,top:-9999}}()).bottom,s2=i2.top,n2=i2.left,o2="auto"):(r2=function(t3){for(var e3=0,i3=0;t3&&t3!=p2;)e3+=t3.offsetLeft||0,i3+=t3.offsetTop||0,t3=t3.parentNode;return{left:e3,top:i3}}(e2.appendTarget),s2=(i2=m2.getBoundingClientRect()).top-r2.top,a2=i2.bottom-1-r2.top,n2=i2.left-r2.left,o2=i2.width+"px"),!h2){let t3=function(){for(var t4=0,i3=e2.appendTarget.parentNode;i3;)t4+=i3.scrollTop||0,i3=i3.parentNode;return t4}();s2+=t3,a2+=t3}s2=Math.floor(s2),a2=Math.ceil(a2),d2=d2===void 0?c2-i2.bottom<t2:d2,l2.style.cssText="left:"+(n2+window.pageXOffset)+"px; width:"+o2+";"+(d2?"top: "+(s2+g2)+"px":"top: "+(a2+g2)+"px"),l2.setAttribute("placement",d2?"top":"bottom"),l2.setAttribute("position",u2)}}},events:{binding(){let t2=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];var e2=this.dropdown.events.callbacks,i2=this.listeners.dropdown=this.listeners.dropdown||{position:this.dropdown.position.bind(this,null),onKeyDown:e2.onKeyDown.bind(this),onMouseOver:e2.onMouseOver.bind(this),onMouseLeave:e2.onMouseLeave.bind(this),onClick:e2.onClick.bind(this),onScroll:e2.onScroll.bind(this)},s2=t2?"addEventListener":"removeEventListener";this.settings.dropdown.position!="manual"&&(document[s2]("scroll",i2.position,!0),window[s2]("resize",i2.position),window[s2]("keydown",i2.onKeyDown)),this.DOM.dropdown[s2]("mouseover",i2.onMouseOver),this.DOM.dropdown[s2]("mouseleave",i2.onMouseLeave),this.DOM.dropdown[s2]("mousedown",i2.onClick),this.DOM.dropdown.content[s2]("scroll",i2.onScroll)},callbacks:{onKeyDown(t2){if(this.state.hasFocus&&!this.state.composing){var e2=this.DOM.dropdown.querySelector(this.settings.classNames.dropdownItemActiveSelector),i2=this.dropdown.getSuggestionDataByNode(e2);switch(t2.key){case"ArrowDown":case"ArrowUp":case"Down":case"Up":t2.preventDefault();var s2=this.dropdown.getAllSuggestionsRefs(),a2=t2.key=="ArrowUp"||t2.key=="Up";e2&&(e2=this.dropdown.getNextOrPrevOption(e2,!a2)),e2&&e2.matches(this.settings.classNames.dropdownItemSelector)||(e2=s2[a2?s2.length-1:0]),this.dropdown.highlightOption(e2,!0);break;case"Escape":case"Esc":this.dropdown.hide();break;case"ArrowRight":if(this.state.actions.ArrowLeft)return;case"Tab":if(this.settings.mode!="mix"&&e2&&!this.settings.autoComplete.rightKey&&!this.state.editing){t2.preventDefault();var n2=this.dropdown.getMappedValue(i2);return this.input.autocomplete.set.call(this,n2),!1}return!0;case"Enter":t2.preventDefault(),this.settings.hooks.suggestionClick(t2,{tagify:this,tagData:i2,suggestionElm:e2}).then(()=>{if(e2)return this.dropdown.selectOption(e2),e2=this.dropdown.getNextOrPrevOption(e2,!a2),void this.dropdown.highlightOption(e2);this.dropdown.hide(),this.settings.mode!="mix"&&this.addTags(this.state.inputText.trim(),!0)}).catch(t3=>t3);break;case"Backspace":{if(this.settings.mode=="mix"||this.state.editing.scope)return;const t3=this.input.raw.call(this);t3!=""&&t3.charCodeAt(0)!=8203||(this.settings.backspace===!0?this.removeTags():this.settings.backspace=="edit"&&setTimeout(this.editTag.bind(this),0))}}}},onMouseOver(t2){var e2=t2.target.closest(this.settings.classNames.dropdownItemSelector);e2&&this.dropdown.highlightOption(e2)},onMouseLeave(t2){this.dropdown.highlightOption()},onClick(t2){if(t2.button==0&&t2.target!=this.DOM.dropdown&&t2.target!=this.DOM.dropdown.content){var e2=t2.target.closest(this.settings.classNames.dropdownItemSelector),i2=this.dropdown.getSuggestionDataByNode(e2);this.state.actions.selectOption=!0,setTimeout(()=>this.state.actions.selectOption=!1,50),this.settings.hooks.suggestionClick(t2,{tagify:this,tagData:i2,suggestionElm:e2}).then(()=>{e2?this.dropdown.selectOption(e2,t2):this.dropdown.hide()}).catch(t3=>console.warn(t3))}},onScroll(t2){var e2=t2.target,i2=e2.scrollTop/(e2.scrollHeight-e2.parentNode.clientHeight)*100;this.trigger("dropdown:scroll",{percentage:Math.round(i2)})}}},getSuggestionDataByNode(t2){var e2=t2&&t2.getAttribute("value");return this.suggestedListItems.find(t3=>t3.value==e2)||null},getNextOrPrevOption(t2){let e2=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];var i2=this.dropdown.getAllSuggestionsRefs(),s2=i2.findIndex(e3=>e3===t2);return e2?i2[s2+1]:i2[s2-1]},highlightOption(t2,e2){var i2,s2=this.settings.classNames.dropdownItemActive;if(this.state.ddItemElm&&(this.state.ddItemElm.classList.remove(s2),this.state.ddItemElm.removeAttribute("aria-selected")),!t2)return this.state.ddItemData=null,this.state.ddItemElm=null,void this.input.autocomplete.suggest.call(this);i2=this.dropdown.getSuggestionDataByNode(t2),this.state.ddItemData=i2,this.state.ddItemElm=t2,t2.classList.add(s2),t2.setAttribute("aria-selected",!0),e2&&(t2.parentNode.scrollTop=t2.clientHeight+t2.offsetTop-t2.parentNode.clientHeight),this.settings.autoComplete&&(this.input.autocomplete.suggest.call(this,i2),this.dropdown.position())},selectOption(t2,e2){var i2=this.settings.dropdown,s2=i2.clearOnSelect,a2=i2.closeOnSelect;if(!t2)return this.addTags(this.state.inputText,!0),void(a2&&this.dropdown.hide());e2=e2||{};var n2=t2.getAttribute("value"),o2=n2=="noMatch",r2=this.suggestedListItems.find(t3=>(t3.value??t3)==n2);this.trigger("dropdown:select",{data:r2,elm:t2,event:e2}),n2&&(r2||o2)?(this.state.editing?this.onEditTagDone(null,g({__isValid:!0},this.normalizeTags([r2])[0])):this[this.settings.mode=="mix"?"addMixTags":"addTags"]([r2||this.input.raw.call(this)],s2),this.DOM.input.parentNode&&(setTimeout(()=>{this.DOM.input.focus(),this.toggleFocusClass(!0)}),a2&&setTimeout(this.dropdown.hide.bind(this)),t2.addEventListener("transitionend",()=>{this.dropdown.fillHeaderFooter(),setTimeout(()=>t2.remove(),100)},{once:!0}),t2.classList.add(this.settings.classNames.dropdownItemHidden))):a2&&setTimeout(this.dropdown.hide.bind(this))},selectAll(t2){this.suggestedListItems.length=0,this.dropdown.hide(),this.dropdown.filterListItems("");var e2=this.dropdown.filterListItems("");return t2||(e2=this.state.dropdown.suggestions),this.addTags(e2,!0),this},filterListItems(t2,e2){var i2,s2,a2,n2,o2,r2=this.settings,l2=r2.dropdown,d2=(e2=e2||{},[]),g2=[],p2=r2.whitelist,u2=l2.maxItems>=0?l2.maxItems:1/0,m2=l2.searchKeys,v2=0;if(!(t2=r2.mode=="select"&&this.value.length&&this.value[0][r2.tagTextProp]==t2?"":t2)||!m2.length)return d2=l2.includeSelectedTags?p2:p2.filter(t3=>!this.isTagDuplicate(h(t3)?t3.value:t3)),this.state.dropdown.suggestions=d2,d2.slice(0,u2);function f2(t3,e3){return e3.toLowerCase().split(" ").every(e4=>t3.includes(e4.toLowerCase()))}for(o2=l2.caseSensitive?""+t2:(""+t2).toLowerCase();v2<p2.length;v2++){let t3,r3;i2=p2[v2]instanceof Object?p2[v2]:{value:p2[v2]};let u3=Object.keys(i2).some(t4=>m2.includes(t4))?m2:["value"];l2.fuzzySearch&&!e2.exact?(a2=u3.reduce((t4,e3)=>t4+" "+(i2[e3]||""),"").toLowerCase().trim(),l2.accentedSearch&&(a2=c(a2),o2=c(o2)),t3=a2.indexOf(o2)==0,r3=a2===o2,s2=f2(a2,o2)):(t3=!0,s2=u3.some(t4=>{var s3=""+(i2[t4]||"");return l2.accentedSearch&&(s3=c(s3),o2=c(o2)),l2.caseSensitive||(s3=s3.toLowerCase()),r3=s3===o2,e2.exact?s3===o2:s3.indexOf(o2)==0})),n2=!l2.includeSelectedTags&&this.isTagDuplicate(h(i2)?i2.value:i2),s2&&!n2&&(r3&&t3?g2.push(i2):l2.sortby=="startsWith"&&t3?d2.unshift(i2):d2.push(i2))}return this.state.dropdown.suggestions=g2.concat(d2),typeof l2.sortby=="function"?l2.sortby(g2.concat(d2),o2):g2.concat(d2).slice(0,u2)},getMappedValue(t2){var e2=this.settings.dropdown.mapValueTo;return e2?typeof e2=="function"?e2(t2):t2[e2]||t2.value:t2.value},createListHTML(t2){return g([],t2).map((t3,i2)=>{typeof t3!="string"&&typeof t3!="number"||(t3={value:t3});var s2=this.dropdown.getMappedValue(t3);return s2=typeof s2=="string"?d(s2):s2,this.settings.templates.dropdownItem.apply(this,[e(e({},t3),{},{mappedValue:s2}),this])}).join("")}};const x="@yaireo/tagify/";var O,D={empty:"empty",exceed:"number of tags exceeded",pattern:"pattern mismatch",duplicate:"already exists",notAllowed:"not allowed"},M={wrapper:(t2,e2)=>`<tags class="${e2.classNames.namespace} ${e2.mode?`${e2.classNames[e2.mode+"Mode"]}`:""} ${t2.className}"
                    ${e2.readonly?"readonly":""}
                    ${e2.disabled?"disabled":""}
                    ${e2.required?"required":""}
                    ${e2.mode==="select"?"spellcheck='false'":""}
                    tabIndex="-1">
            <span ${!e2.readonly&&e2.userInput?"contenteditable":""} tabIndex="0" data-placeholder="${e2.placeholder||"&#8203;"}" aria-placeholder="${e2.placeholder||""}"
                class="${e2.classNames.input}"
                role="textbox"
                aria-autocomplete="both"
                aria-multiline="${e2.mode=="mix"}"></span>
                &#8203;
        </tags>`,tag(t2,e2){let i2=e2.settings;return`<tag title="${t2.title||t2.value}"
                    contenteditable='false'
                    spellcheck='false'
                    tabIndex="${i2.a11y.focusableTags?0:-1}"
                    class="${i2.classNames.tag} ${t2.class||""}"
                    ${this.getAttributes(t2)}>
            <x title='' class="${i2.classNames.tagX}" role='button' aria-label='remove tag'></x>
            <div>
                <span class="${i2.classNames.tagText}">${t2[i2.tagTextProp]||t2.value}</span>
            </div>
        </tag>`},dropdown(t2){var e2=t2.dropdown,i2=e2.position=="manual",s2=`${t2.classNames.dropdown}`;return`<div class="${i2?"":s2} ${e2.classname}" role="listbox" aria-labelledby="dropdown">
                    <div data-selector='tagify-suggestions-wrapper' class="${t2.classNames.dropdownWrapper}"></div>
                </div>`},dropdownContent(t2){var e2=this.settings,i2=this.state.dropdown.suggestions;return`
            ${e2.templates.dropdownHeader.call(this,i2)}
            ${t2}
            ${e2.templates.dropdownFooter.call(this,i2)}
        `},dropdownItem(t2){return`<div ${this.getAttributes(t2)}
                    class='${this.settings.classNames.dropdownItem} ${t2.class?t2.class:""}'
                    tabindex="0"
                    role="option">${t2.mappedValue||t2.value}</div>`},dropdownHeader(t2){return`<header data-selector='tagify-suggestions-header' class="${this.settings.classNames.dropdownHeader}"></header>`},dropdownFooter(t2){var e2=t2.length-this.settings.dropdown.maxItems;return e2>0?`<footer data-selector='tagify-suggestions-footer' class="${this.settings.classNames.dropdownFooter}">
                ${e2} more items. Refine your search.
            </footer>`:""},dropdownItemNoMatch:null},I={customBinding(){this.customEventsList.forEach(t2=>{this.on(t2,this.settings.callbacks[t2])})},binding(){let t2=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];var e2,i2=this.events.callbacks,s2=t2?"addEventListener":"removeEventListener";if(!this.state.mainEvents||!t2){for(var a2 in this.state.mainEvents=t2,t2&&!this.listeners.main&&(this.events.bindGlobal.call(this),this.settings.isJQueryPlugin&&jQuery(this.DOM.originalInput).on("tagify.removeAllTags",this.removeAllTags.bind(this))),e2=this.listeners.main=this.listeners.main||{focus:["input",i2.onFocusBlur.bind(this)],keydown:["input",i2.onKeydown.bind(this)],click:["scope",i2.onClickScope.bind(this)],dblclick:["scope",i2.onDoubleClickScope.bind(this)],paste:["input",i2.onPaste.bind(this)],drop:["input",i2.onDrop.bind(this)],compositionstart:["input",i2.onCompositionStart.bind(this)],compositionend:["input",i2.onCompositionEnd.bind(this)]})this.DOM[e2[a2][0]][s2](a2,e2[a2][1]);clearInterval(this.listeners.main.originalInputValueObserverInterval),this.listeners.main.originalInputValueObserverInterval=setInterval(i2.observeOriginalInputValue.bind(this),500);var n2=this.listeners.main.inputMutationObserver||new MutationObserver(i2.onInputDOMChange.bind(this));n2.disconnect(),this.settings.mode=="mix"&&n2.observe(this.DOM.input,{childList:!0})}},bindGlobal(t2){var e2,i2=this.events.callbacks,s2=t2?"removeEventListener":"addEventListener";if(this.listeners&&(t2||!this.listeners.global))for(e2 of(this.listeners.global=this.listeners.global||[{type:this.isIE?"keydown":"input",target:this.DOM.input,cb:i2[this.isIE?"onInputIE":"onInput"].bind(this)},{type:"keydown",target:window,cb:i2.onWindowKeyDown.bind(this)},{type:"blur",target:this.DOM.input,cb:i2.onFocusBlur.bind(this)},{type:"click",target:document,cb:i2.onClickAnywhere.bind(this)}],this.listeners.global))e2.target[s2](e2.type,e2.cb)},unbindGlobal(){this.events.bindGlobal.call(this,!0)},callbacks:{onFocusBlur(t2){var _a,_b;var e2=this.settings,i2=t2.target?this.trim(t2.target.textContent):"",s2=(_b=(_a=this.value)==null?void 0:_a[0])==null?void 0:_b[e2.tagTextProp],a2=t2.type,n2=e2.dropdown.enabled>=0,o2={relatedTarget:t2.relatedTarget},r2=this.state.actions.selectOption&&(n2||!e2.dropdown.closeOnSelect),l2=this.state.actions.addNew&&n2,d2=t2.relatedTarget&&v.call(this,t2.relatedTarget)&&this.DOM.scope.contains(t2.relatedTarget);if(a2=="blur"){if(t2.relatedTarget===this.DOM.scope)return this.dropdown.hide(),void this.DOM.input.focus();this.postUpdate(),e2.onChangeAfterBlur&&this.triggerChangeEvent()}if(!r2&&!l2)if(this.state.hasFocus=a2=="focus"&&+new Date,this.toggleFocusClass(this.state.hasFocus),e2.mode!="mix"){if(a2=="focus")return this.trigger("focus",o2),void(e2.dropdown.enabled!==0&&e2.userInput||this.dropdown.show(this.value.length?"":void 0));a2=="blur"&&(this.trigger("blur",o2),this.loading(!1),e2.mode=="select"&&(d2&&(this.removeTags(),i2=""),s2===i2&&(i2="")),i2&&!this.state.actions.selectOption&&e2.addTagOnBlur&&this.addTags(i2,!0)),this.DOM.input.removeAttribute("style"),this.dropdown.hide()}else a2=="focus"?this.trigger("focus",o2):t2.type=="blur"&&(this.trigger("blur",o2),this.loading(!1),this.dropdown.hide(),this.state.dropdown.visible=void 0,this.setStateSelection())},onCompositionStart(t2){this.state.composing=!0},onCompositionEnd(t2){this.state.composing=!1},onWindowKeyDown(t2){var e2,i2=document.activeElement,s2=v.call(this,i2)&&this.DOM.scope.contains(document.activeElement),a2=s2&&i2.hasAttribute("readonly");if(s2&&!a2)switch(e2=i2.nextElementSibling,t2.key){case"Backspace":this.settings.readonly||(this.removeTags(i2),(e2||this.DOM.input).focus());break;case"Enter":setTimeout(this.editTag.bind(this),0,i2)}},onKeydown(t2){var e2=this.settings;if(!this.state.composing&&e2.userInput){e2.mode=="select"&&e2.enforceWhitelist&&this.value.length&&t2.key!="Tab"&&t2.preventDefault();var i2=this.trim(t2.target.textContent);if(this.trigger("keydown",{event:t2}),e2.mode=="mix"){switch(t2.key){case"Left":case"ArrowLeft":this.state.actions.ArrowLeft=!0;break;case"Delete":case"Backspace":if(this.state.editing)return;var s2=document.getSelection(),a2=t2.key=="Delete"&&s2.anchorOffset==(s2.anchorNode.length||0),n2=s2.anchorNode.previousSibling,r2=s2.anchorNode.nodeType==1||!s2.anchorOffset&&n2&&n2.nodeType==1&&s2.anchorNode.previousSibling;o(this.DOM.input.innerHTML);var d2,h2,g2,p2=this.getTagElms();if(e2.backspace=="edit"&&r2)return d2=s2.anchorNode.nodeType==1?null:s2.anchorNode.previousElementSibling,setTimeout(this.editTag.bind(this),0,d2),void t2.preventDefault();if(u()&&r2 instanceof Element)return g2=l(r2),r2.hasAttribute("readonly")||r2.remove(),this.DOM.input.focus(),void setTimeout(()=>{this.placeCaretAfterNode(g2),this.DOM.input.click()});if(s2.anchorNode.nodeName=="BR")return;if((a2||r2)&&s2.anchorNode.nodeType==1?h2=s2.anchorOffset==0?a2?p2[0]:null:p2[Math.min(p2.length,s2.anchorOffset)-1]:a2?h2=s2.anchorNode.nextElementSibling:r2 instanceof Element&&(h2=r2),s2.anchorNode.nodeType==3&&!s2.anchorNode.nodeValue&&s2.anchorNode.previousElementSibling&&t2.preventDefault(),(r2||a2)&&!e2.backspace||s2.type!="Range"&&!s2.anchorOffset&&s2.anchorNode==this.DOM.input&&t2.key!="Delete")return void t2.preventDefault();if(s2.type!="Range"&&h2&&h2.hasAttribute("readonly"))return void this.placeCaretAfterNode(l(h2));clearTimeout(O),O=setTimeout(()=>{var t3=document.getSelection();o(this.DOM.input.innerHTML),!a2&&t3.anchorNode.previousSibling,this.value=[].map.call(p2,(t4,e3)=>{var i3=T(t4);if(t4.parentNode||i3.readonly)return i3;this.trigger("remove",{tag:t4,index:e3,data:i3})}).filter(t4=>t4)},20)}return!0}switch(t2.key){case"Backspace":e2.mode=="select"&&e2.enforceWhitelist&&this.value.length?this.removeTags():this.state.dropdown.visible&&e2.dropdown.position!="manual"||t2.target.textContent!=""&&i2.charCodeAt(0)!=8203||(e2.backspace===!0?this.removeTags():e2.backspace=="edit"&&setTimeout(this.editTag.bind(this),0));break;case"Esc":case"Escape":if(this.state.dropdown.visible)return;t2.target.blur();break;case"Down":case"ArrowDown":this.state.dropdown.visible||this.dropdown.show();break;case"ArrowRight":{let t3=this.state.inputSuggestion||this.state.ddItemData;if(t3&&e2.autoComplete.rightKey)return void this.addTags([t3],!0);break}case"Tab":{let s3=e2.mode=="select";if(!i2||s3)return!0;t2.preventDefault()}case"Enter":if(this.state.dropdown.visible&&e2.dropdown.position!="manual")return;t2.preventDefault(),setTimeout(()=>{this.state.dropdown.visible||this.state.actions.selectOption||this.addTags(i2,!0)})}}},onInput(t2){this.postUpdate();var e2=this.settings;if(e2.mode=="mix")return this.events.callbacks.onMixTagsInput.call(this,t2);var i2=this.input.normalize.call(this),s2=i2.length>=e2.dropdown.enabled,a2={value:i2,inputElm:this.DOM.input},n2=this.validateTag({value:i2});e2.mode=="select"&&this.toggleScopeValidation(n2),a2.isValid=n2,this.state.inputText!=i2&&(this.input.set.call(this,i2,!1),i2.search(e2.delimiters)!=-1?this.addTags(i2)&&this.input.set.call(this):e2.dropdown.enabled>=0&&this.dropdown[s2?"show":"hide"](i2),this.trigger("input",a2))},onMixTagsInput(t2){var e2,i2,s2,a2,n2,o2,r2,l2,d2=this.settings,h2=this.value.length,p2=this.getTagElms(),c2=document.createDocumentFragment(),m2=window.getSelection().getRangeAt(0),v2=[].map.call(p2,t3=>T(t3).value);if(t2.inputType=="deleteContentBackward"&&u()&&this.events.callbacks.onKeydown.call(this,{target:t2.target,key:"Backspace"}),this.value.slice().forEach(t3=>{t3.readonly&&!v2.includes(t3.value)&&c2.appendChild(this.createTagElem(t3))}),c2.childNodes.length&&(m2.insertNode(c2),this.setRangeAtStartEnd(!1,c2.lastChild)),p2.length!=h2)return this.value=[].map.call(this.getTagElms(),t3=>T(t3)),void this.update({withoutChangeEvent:!0});if(this.hasMaxTags())return!0;if(window.getSelection&&(o2=window.getSelection()).rangeCount>0&&o2.anchorNode.nodeType==3){if((m2=o2.getRangeAt(0).cloneRange()).collapse(!0),m2.setStart(o2.focusNode,0),s2=(e2=m2.toString().slice(0,m2.endOffset)).split(d2.pattern).length-1,(i2=e2.match(d2.pattern))&&(a2=e2.slice(e2.lastIndexOf(i2[i2.length-1]))),a2){if(this.state.actions.ArrowLeft=!1,this.state.tag={prefix:a2.match(d2.pattern)[0],value:a2.replace(d2.pattern,"")},this.state.tag.baseOffset=o2.baseOffset-this.state.tag.value.length,l2=this.state.tag.value.match(d2.delimiters))return this.state.tag.value=this.state.tag.value.replace(d2.delimiters,""),this.state.tag.delimiters=l2[0],this.addTags(this.state.tag.value,d2.dropdown.clearOnSelect),void this.dropdown.hide();n2=this.state.tag.value.length>=d2.dropdown.enabled;try{r2=(r2=this.state.flaggedTags[this.state.tag.baseOffset]).prefix==this.state.tag.prefix&&r2.value[0]==this.state.tag.value[0],this.state.flaggedTags[this.state.tag.baseOffset]&&!this.state.tag.value&&delete this.state.flaggedTags[this.state.tag.baseOffset]}catch{}(r2||s2<this.state.mixMode.matchedPatternCount)&&(n2=!1)}else this.state.flaggedTags={};this.state.mixMode.matchedPatternCount=s2}setTimeout(()=>{this.update({withoutChangeEvent:!0}),this.trigger("input",g({},this.state.tag,{textContent:this.DOM.input.textContent})),this.state.tag&&this.dropdown[n2?"show":"hide"](this.state.tag.value)},10)},onInputIE(t2){var e2=this;setTimeout(function(){e2.events.callbacks.onInput.call(e2,t2)})},observeOriginalInputValue(){this.DOM.originalInput.parentNode||this.destroy(),this.DOM.originalInput.value!=this.DOM.originalInput.tagifyValue&&this.loadOriginalValues()},onClickAnywhere(t2){t2.target==this.DOM.scope||this.DOM.scope.contains(t2.target)||(this.toggleFocusClass(!1),this.state.hasFocus=!1)},onClickScope(t2){var e2=this.settings,i2=t2.target.closest("."+e2.classNames.tag),s2=+new Date-this.state.hasFocus;if(t2.target!=this.DOM.scope){if(!t2.target.classList.contains(e2.classNames.tagX))return i2?(this.trigger("click",{tag:i2,index:this.getNodeIndex(i2),data:T(i2),event:t2}),void(e2.editTags!==1&&e2.editTags.clicks!==1||this.events.callbacks.onDoubleClickScope.call(this,t2))):void(t2.target==this.DOM.input&&(e2.mode=="mix"&&this.fixFirefoxLastTagNoCaret(),s2>500)?this.state.dropdown.visible?this.dropdown.hide():e2.dropdown.enabled===0&&e2.mode!="mix"&&this.dropdown.show(this.value.length?"":void 0):e2.mode!="select"||e2.dropdown.enabled!==0||this.state.dropdown.visible||this.dropdown.show());this.removeTags(t2.target.parentNode)}else this.DOM.input.focus()},onPaste(t2){t2.preventDefault();var e2,i2,s2=this.settings;if(s2.mode=="select"&&s2.enforceWhitelist||!s2.userInput)return!1;s2.readonly||(e2=t2.clipboardData||window.clipboardData,i2=e2.getData("Text"),s2.hooks.beforePaste(t2,{tagify:this,pastedText:i2,clipboardData:e2}).then(e3=>{e3===void 0&&(e3=i2),e3&&(this.injectAtCaret(e3,window.getSelection().getRangeAt(0)),this.settings.mode=="mix"?this.events.callbacks.onMixTagsInput.call(this,t2):this.settings.pasteAsTags?this.addTags(this.state.inputText+e3,!0):this.state.inputText=e3)}).catch(t3=>t3))},onDrop(t2){t2.preventDefault()},onEditTagInput(t2,e2){var i2=t2.closest("."+this.settings.classNames.tag),s2=this.getNodeIndex(i2),a2=T(i2),n2=this.input.normalize.call(this,t2),o2={[this.settings.tagTextProp]:n2,__tagId:a2.__tagId},r2=this.validateTag(o2);this.editTagChangeDetected(g(a2,o2))||t2.originalIsValid!==!0||(r2=!0),i2.classList.toggle(this.settings.classNames.tagInvalid,r2!==!0),a2.__isValid=r2,i2.title=r2===!0?a2.title||a2.value:r2,n2.length>=this.settings.dropdown.enabled&&(this.state.editing&&(this.state.editing.value=n2),this.dropdown.show(n2)),this.trigger("edit:input",{tag:i2,index:s2,data:g({},this.value[s2],{newValue:n2}),event:e2})},onEditTagPaste(t2,e2){var i2=(e2.clipboardData||window.clipboardData).getData("Text");e2.preventDefault();var s2=f(i2);this.setRangeAtStartEnd(!1,s2)},onEditTagFocus(t2){this.state.editing={scope:t2,input:t2.querySelector("[contenteditable]")}},onEditTagBlur(t2){if(this.state.hasFocus||this.toggleFocusClass(),this.DOM.scope.contains(t2)){var e2,i2,s2=this.settings,a2=t2.closest("."+s2.classNames.tag),n2=T(a2),o2=this.input.normalize.call(this,t2),r2={[s2.tagTextProp]:o2,__tagId:n2.__tagId},l2=n2.__originalData,d2=this.editTagChangeDetected(g(n2,r2)),h2=this.validateTag(r2);if(o2)if(d2){if(e2=this.hasMaxTags(),i2=g({},l2,{[s2.tagTextProp]:this.trim(o2),__isValid:h2}),s2.transformTag.call(this,i2,l2),(h2=(!e2||l2.__isValid===!0)&&this.validateTag(i2))!==!0){if(this.trigger("invalid",{data:i2,tag:a2,message:h2}),s2.editTags.keepInvalid)return;s2.keepInvalidTags?i2.__isValid=h2:i2=l2}else s2.keepInvalidTags&&(delete i2.title,delete i2["aria-invalid"],delete i2.class);this.onEditTagDone(a2,i2)}else this.onEditTagDone(a2,l2);else this.onEditTagDone(a2)}},onEditTagkeydown(t2,e2){if(!this.state.composing)switch(this.trigger("edit:keydown",{event:t2}),t2.key){case"Esc":case"Escape":e2.parentNode.replaceChild(e2.__tagifyTagData.__originalHTML,e2),this.state.editing=!1;case"Enter":case"Tab":t2.preventDefault(),t2.target.blur()}},onDoubleClickScope(t2){var e2,i2,s2=t2.target.closest("."+this.settings.classNames.tag),a2=T(s2),n2=this.settings;s2&&n2.userInput&&a2.editable!==!1&&(e2=s2.classList.contains(this.settings.classNames.tagEditing),i2=s2.hasAttribute("readonly"),n2.mode=="select"||n2.readonly||e2||i2||!this.settings.editTags||this.editTag(s2),this.toggleFocusClass(!0),this.trigger("dblclick",{tag:s2,index:this.getNodeIndex(s2),data:T(s2)}))},onInputDOMChange(t2){t2.forEach(t3=>{t3.addedNodes.forEach(t4=>{var _a;if(t4.outerHTML=="<div><br></div>")t4.replaceWith(document.createElement("br"));else if(t4.nodeType==1&&t4.querySelector(this.settings.classNames.tagSelector)){let e3=document.createTextNode("");t4.childNodes[0].nodeType==3&&t4.previousSibling.nodeName!="BR"&&(e3=document.createTextNode(`
`)),t4.replaceWith(e3,...[...t4.childNodes].slice(0,-1)),this.placeCaretAfterNode(e3)}else if(v.call(this,t4)&&(((_a=t4.previousSibling)==null?void 0:_a.nodeType)!=3||t4.previousSibling.textContent||t4.previousSibling.remove(),t4.previousSibling&&t4.previousSibling.nodeName=="BR")){t4.previousSibling.replaceWith(`
â`);let e3=t4.nextSibling,i2="";for(;e3;)i2+=e3.textContent,e3=e3.nextSibling;i2.trim()&&this.placeCaretAfterNode(t4.previousSibling)}}),t3.removedNodes.forEach(t4=>{t4&&t4.nodeName=="BR"&&v.call(this,e2)&&(this.removeTags(e2),this.fixFirefoxLastTagNoCaret())})});var e2=this.DOM.input.lastChild;e2&&e2.nodeValue==""&&e2.remove(),e2&&e2.nodeName=="BR"||this.DOM.input.appendChild(document.createElement("br"))}}};function N(t2,e2){if(!t2){console.warn("Tagify:","input element not found",t2);const e3=new Proxy(this,{get:()=>()=>e3});return e3}if(t2.__tagify)return console.warn("Tagify: ","input element is already Tagified - Same instance is returned.",t2),t2.__tagify;var i2;g(this,function(t3){var e3=document.createTextNode("");function i3(t4,i4,s2){s2&&i4.split(/\s+/g).forEach(i5=>e3[t4+"EventListener"].call(e3,i5,s2))}return{off(t4,e4){return i3("remove",t4,e4),this},on(t4,e4){return e4&&typeof e4=="function"&&i3("add",t4,e4),this},trigger(i4,s2,a2){var n2;if(a2=a2||{cloneData:!0},i4)if(t3.settings.isJQueryPlugin)i4=="remove"&&(i4="removeTag"),jQuery(t3.DOM.originalInput).triggerHandler(i4,[s2]);else{try{var o2=typeof s2=="object"?s2:{value:s2};if((o2=a2.cloneData?g({},o2):o2).tagify=this,s2.event&&(o2.event=this.cloneEvent(s2.event)),s2 instanceof Object)for(var r2 in s2)s2[r2]instanceof HTMLElement&&(o2[r2]=s2[r2]);n2=new CustomEvent(i4,{detail:o2})}catch(t4){console.warn(t4)}e3.dispatchEvent(n2)}}}}(this)),this.isFirefox=/firefox|fxios/i.test(navigator.userAgent)&&!/seamonkey/i.test(navigator.userAgent),this.isIE=window.document.documentMode,e2=e2||{},this.getPersistedData=(i2=e2.id,t3=>{let e3,s2="/"+t3;if(localStorage.getItem(x+i2+"/v",1)==1)try{e3=JSON.parse(localStorage[x+i2+s2])}catch{}return e3}),this.setPersistedData=(t3=>t3?(localStorage.setItem(x+t3+"/v",1),(e3,i3)=>{let s2="/"+i3,a2=JSON.stringify(e3);e3&&i3&&(localStorage.setItem(x+t3+s2,a2),dispatchEvent(new Event("storage")))}):()=>{})(e2.id),this.clearPersistedData=(t3=>e3=>{const i3=x+"/"+t3+"/";if(e3)localStorage.removeItem(i3+e3);else for(let t4 in localStorage)t4.includes(i3)&&localStorage.removeItem(t4)})(e2.id),this.applySettings(t2,e2),this.state={inputText:"",editing:!1,composing:!1,actions:{},mixMode:{},dropdown:{},flaggedTags:{}},this.value=[],this.listeners={},this.DOM={},this.build(t2),b.call(this),this.getCSSVars(),this.loadOriginalValues(),this.events.customBinding.call(this),this.events.binding.call(this),t2.autofocus&&this.DOM.input.focus(),t2.__tagify=this}return N.prototype={_dropdown:y,getSetTagData:T,helpers:{sameStr:s,removeCollectionProp:a,omit:n,isObject:h,parseHTML:r,escapeHTML:d,extend:g,concatWithoutDups:p,getUID:m,isNodeTag:v},customEventsList:["change","add","remove","invalid","input","click","keydown","focus","blur","edit:input","edit:beforeUpdate","edit:updated","edit:start","edit:keydown","dropdown:show","dropdown:hide","dropdown:select","dropdown:updated","dropdown:noMatch","dropdown:scroll"],dataProps:["__isValid","__removed","__originalData","__originalHTML","__tagId"],trim(t2){return this.settings.trim&&t2&&typeof t2=="string"?t2.trim():t2},parseHTML:r,templates:M,parseTemplate(t2,e2){return r((t2=this.settings.templates[t2]||t2).apply(this,e2))},set whitelist(t2){const e2=t2&&Array.isArray(t2);this.settings.whitelist=e2?t2:[],this.setPersistedData(e2?t2:[],"whitelist")},get whitelist(){return this.settings.whitelist},generateClassSelectors(t2){for(let e2 in t2){let i2=e2;Object.defineProperty(t2,i2+"Selector",{get(){return"."+this[i2].split(" ")[0]}})}},applySettings(t2,i2){var _a,_b;w.templates=this.templates;var s2=g({},w,i2.mode=="mix"?{dropdown:{position:"text"}}:{}),a2=this.settings=g({},s2,i2);if(a2.disabled=t2.hasAttribute("disabled"),a2.readonly=a2.readonly||t2.hasAttribute("readonly"),a2.placeholder=d(t2.getAttribute("placeholder")||a2.placeholder||""),a2.required=t2.hasAttribute("required"),this.generateClassSelectors(a2.classNames),a2.dropdown.includeSelectedTags===void 0&&(a2.dropdown.includeSelectedTags=a2.duplicates),this.isIE&&(a2.autoComplete=!1),["whitelist","blacklist"].forEach(e2=>{var i3=t2.getAttribute("data-"+e2);i3&&(i3=i3.split(a2.delimiters))instanceof Array&&(a2[e2]=i3)}),"autoComplete"in i2&&!h(i2.autoComplete)&&(a2.autoComplete=w.autoComplete,a2.autoComplete.enabled=i2.autoComplete),a2.mode=="mix"&&(a2.pattern=a2.pattern||/@/,a2.autoComplete.rightKey=!0,a2.delimiters=i2.delimiters||null,a2.tagTextProp&&!a2.dropdown.searchKeys.includes(a2.tagTextProp)&&a2.dropdown.searchKeys.push(a2.tagTextProp)),t2.pattern)try{a2.pattern=new RegExp(t2.pattern)}catch{}if(a2.delimiters){a2._delimiters=a2.delimiters;try{a2.delimiters=new RegExp(this.settings.delimiters,"g")}catch{}}a2.disabled&&(a2.userInput=!1),this.TEXTS=e(e({},D),a2.texts||{}),(a2.mode!="select"||(_a=i2.dropdown)!=null&&_a.enabled)&&a2.userInput||(a2.dropdown.enabled=0),a2.dropdown.appendTarget=((_b=i2.dropdown)==null?void 0:_b.appendTarget)||document.body;let n2=this.getPersistedData("whitelist");Array.isArray(n2)&&(this.whitelist=Array.isArray(a2.whitelist)?p(a2.whitelist,n2):n2)},getAttributes(t2){var e2,i2=this.getCustomAttributes(t2),s2="";for(e2 in i2)s2+=" "+e2+(t2[e2]!==void 0?`="${i2[e2]}"`:"");return s2},getCustomAttributes(t2){if(!h(t2))return"";var e2,i2={};for(e2 in t2)e2.slice(0,2)!="__"&&e2!="class"&&t2.hasOwnProperty(e2)&&t2[e2]!==void 0&&(i2[e2]=d(t2[e2]));return i2},setStateSelection(){var t2=window.getSelection(),e2={anchorOffset:t2.anchorOffset,anchorNode:t2.anchorNode,range:t2.getRangeAt&&t2.rangeCount&&t2.getRangeAt(0)};return this.state.selection=e2,e2},getCSSVars(){var t2=getComputedStyle(this.DOM.scope,null),e2;this.CSSVars={tagHideTransition:(t3=>{let e3=t3.value;return t3.unit=="s"?1e3*e3:e3})(function(t3){if(!t3)return{};var e3=(t3=t3.trim().split(" ")[0]).split(/\d+/g).filter(t4=>t4).pop().trim();return{value:+t3.split(e3).filter(t4=>t4)[0].trim(),unit:e3}}((e2="tag-hide-transition",t2.getPropertyValue("--"+e2))))}},build(t2){var e2=this.DOM;this.settings.mixMode.integrated?(e2.originalInput=null,e2.scope=t2,e2.input=t2):(e2.originalInput=t2,e2.originalInput_tabIndex=t2.tabIndex,e2.scope=this.parseTemplate("wrapper",[t2,this.settings]),e2.input=e2.scope.querySelector(this.settings.classNames.inputSelector),t2.parentNode.insertBefore(e2.scope,t2),t2.tabIndex=-1)},destroy(){this.events.unbindGlobal.call(this),this.DOM.scope.parentNode.removeChild(this.DOM.scope),this.DOM.originalInput.tabIndex=this.DOM.originalInput_tabIndex,delete this.DOM.originalInput.__tagify,this.dropdown.hide(!0),clearTimeout(this.dropdownHide__bindEventsTimeout),clearInterval(this.listeners.main.originalInputValueObserverInterval)},loadOriginalValues(t2){var e2,i2=this.settings;if(this.state.blockChangeEvent=!0,t2===void 0){const e3=this.getPersistedData("value");t2=e3&&!this.DOM.originalInput.value?e3:i2.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value}if(this.removeAllTags(),t2)if(i2.mode=="mix")this.parseMixTags(t2),(e2=this.DOM.input.lastChild)&&e2.tagName=="BR"||this.DOM.input.insertAdjacentHTML("beforeend","<br>");else{try{JSON.parse(t2)instanceof Array&&(t2=JSON.parse(t2))}catch{}this.addTags(t2,!0).forEach(t3=>t3&&t3.classList.add(i2.classNames.tagNoAnimation))}else this.postUpdate();this.state.lastOriginalValueReported=i2.mixMode.integrated?"":this.DOM.originalInput.value},cloneEvent(t2){var e2={};for(var i2 in t2)i2!="path"&&(e2[i2]=t2[i2]);return e2},loading(t2){return this.state.isLoading=t2,this.DOM.scope.classList[t2?"add":"remove"](this.settings.classNames.scopeLoading),this},tagLoading(t2,e2){return t2&&t2.classList[e2?"add":"remove"](this.settings.classNames.tagLoading),this},toggleClass(t2,e2){typeof t2=="string"&&this.DOM.scope.classList.toggle(t2,e2)},toggleScopeValidation(t2){var e2=t2===!0||t2===void 0;!this.settings.required&&t2&&t2===this.TEXTS.empty&&(e2=!0),this.toggleClass(this.settings.classNames.tagInvalid,!e2),this.DOM.scope.title=e2?"":t2},toggleFocusClass(t2){this.toggleClass(this.settings.classNames.focus,!!t2)},triggerChangeEvent:function(){if(!this.settings.mixMode.integrated){var t2=this.DOM.originalInput,e2=this.state.lastOriginalValueReported!==t2.value,i2=new CustomEvent("change",{bubbles:!0});e2&&(this.state.lastOriginalValueReported=t2.value,i2.simulated=!0,t2._valueTracker&&t2._valueTracker.setValue(Math.random()),t2.dispatchEvent(i2),this.trigger("change",this.state.lastOriginalValueReported),t2.value=this.state.lastOriginalValueReported)}},events:I,fixFirefoxLastTagNoCaret(){},setRangeAtStartEnd(t2,e2){if(e2){t2=typeof t2=="number"?t2:!!t2,e2=e2.lastChild||e2;var i2=document.getSelection();if(i2.focusNode instanceof Element&&!this.DOM.input.contains(i2.focusNode))return!0;try{i2.rangeCount>=1&&["Start","End"].forEach(s2=>i2.getRangeAt(0)["set"+s2](e2,t2||e2.length))}catch{}}},placeCaretAfterNode(t2){if(t2&&t2.parentNode){var e2=t2,i2=window.getSelection(),s2=i2.getRangeAt(0);i2.rangeCount&&(s2.setStartAfter(e2),s2.collapse(!0),i2.removeAllRanges(),i2.addRange(s2))}},insertAfterTag(t2,e2){if(e2=e2||this.settings.mixMode.insertAfterTag,t2&&t2.parentNode&&e2)return e2=typeof e2=="string"?document.createTextNode(e2):e2,t2.parentNode.insertBefore(e2,t2.nextSibling),e2},editTagChangeDetected(t2){var e2=t2.__originalData;for(var i2 in e2)if(!this.dataProps.includes(i2)&&t2[i2]!=e2[i2])return!0;return!1},getTagTextNode(t2){return t2.querySelector(this.settings.classNames.tagTextSelector)},setTagTextNode(t2,e2){this.getTagTextNode(t2).innerHTML=d(e2)},editTag(t2,e2){t2=t2||this.getLastTag(),e2=e2||{},this.dropdown.hide();var i2=this.settings,s2=this.getTagTextNode(t2),a2=this.getNodeIndex(t2),n2=T(t2),o2=this.events.callbacks,r2=this,l2=!0;if(s2){if(!(n2 instanceof Object&&"editable"in n2)||n2.editable)return n2=T(t2,{__originalData:g({},n2),__originalHTML:t2.cloneNode(!0)}),T(n2.__originalHTML,n2.__originalData),s2.setAttribute("contenteditable",!0),t2.classList.add(i2.classNames.tagEditing),s2.addEventListener("focus",o2.onEditTagFocus.bind(this,t2)),s2.addEventListener("blur",function(){setTimeout(()=>o2.onEditTagBlur.call(r2,r2.getTagTextNode(t2)))}),s2.addEventListener("input",o2.onEditTagInput.bind(this,s2)),s2.addEventListener("paste",o2.onEditTagPaste.bind(this,s2)),s2.addEventListener("keydown",e3=>o2.onEditTagkeydown.call(this,e3,t2)),s2.addEventListener("compositionstart",o2.onCompositionStart.bind(this)),s2.addEventListener("compositionend",o2.onCompositionEnd.bind(this)),e2.skipValidation||(l2=this.editTagToggleValidity(t2)),s2.originalIsValid=l2,this.trigger("edit:start",{tag:t2,index:a2,data:n2,isValid:l2}),s2.focus(),this.setRangeAtStartEnd(!1,s2),this}else console.warn("Cannot find element in Tag template: .",i2.classNames.tagTextSelector)},editTagToggleValidity(t2,e2){var i2;if(e2=e2||T(t2))return(i2=!("__isValid"in e2)||e2.__isValid===!0)||this.removeTagsFromValue(t2),this.update(),t2.classList.toggle(this.settings.classNames.tagNotAllowed,!i2),e2.__isValid;console.warn("tag has no data: ",t2,e2)},onEditTagDone(t2,e2){e2=e2||{};var i2={tag:t2=t2||this.state.editing.scope,index:this.getNodeIndex(t2),previousData:T(t2),data:e2};this.trigger("edit:beforeUpdate",i2,{cloneData:!1}),this.state.editing=!1,delete e2.__originalData,delete e2.__originalHTML,t2&&e2[this.settings.tagTextProp]?(t2=this.replaceTag(t2,e2),this.editTagToggleValidity(t2,e2),this.settings.a11y.focusableTags?t2.focus():this.placeCaretAfterNode(t2)):t2&&this.removeTags(t2),this.trigger("edit:updated",i2),this.dropdown.hide(),this.settings.keepInvalidTags&&this.reCheckInvalidTags()},replaceTag(t2,e2){e2&&e2.value||(e2=t2.__tagifyTagData),e2.__isValid&&e2.__isValid!=1&&g(e2,this.getInvalidTagAttrs(e2,e2.__isValid));var i2=this.createTagElem(e2);return t2.parentNode.replaceChild(i2,t2),this.updateValueByDOMTags(),i2},updateValueByDOMTags(){this.value.length=0,[].forEach.call(this.getTagElms(),t2=>{t2.classList.contains(this.settings.classNames.tagNotAllowed.split(" ")[0])||this.value.push(T(t2))}),this.update()},injectAtCaret(t2,e2){var _a;return!(e2=e2||((_a=this.state.selection)==null?void 0:_a.range))&&t2?(this.appendMixTags(t2),this):(f(t2,e2),this.setRangeAtStartEnd(!1,t2),this.updateValueByDOMTags(),this.update(),this)},input:{set(){let t2=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e2=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];var i2=this.settings.dropdown.closeOnSelect;this.state.inputText=t2,e2&&(this.DOM.input.innerHTML=d(""+t2)),!t2&&i2&&this.dropdown.hide.bind(this),this.input.autocomplete.suggest.call(this),this.input.validate.call(this)},raw(){return this.DOM.input.textContent},validate(){var t2=!this.state.inputText||this.validateTag({value:this.state.inputText})===!0;return this.DOM.input.classList.toggle(this.settings.classNames.inputInvalid,!t2),t2},normalize(t2){var e2=t2||this.DOM.input,i2=[];e2.childNodes.forEach(t3=>t3.nodeType==3&&i2.push(t3.nodeValue)),i2=i2.join(`
`);try{i2=i2.replace(/(?:\r\n|\r|\n)/g,this.settings.delimiters.source.charAt(0))}catch{}return i2=i2.replace(/\s/g," "),this.trim(i2)},autocomplete:{suggest(t2){if(this.settings.autoComplete.enabled){typeof(t2=t2||{value:""})=="string"&&(t2={value:t2});var e2=this.dropdown.getMappedValue(t2);if(typeof e2!="number"){var i2=e2.substr(0,this.state.inputText.length).toLowerCase(),s2=e2.substring(this.state.inputText.length);e2&&this.state.inputText&&i2==this.state.inputText.toLowerCase()?(this.DOM.input.setAttribute("data-suggest",s2),this.state.inputSuggestion=t2):(this.DOM.input.removeAttribute("data-suggest"),delete this.state.inputSuggestion)}}},set(t2){var e2=this.DOM.input.getAttribute("data-suggest"),i2=t2||(e2?this.state.inputText+e2:null);return!!i2&&(this.settings.mode=="mix"?this.replaceTextWithNode(document.createTextNode(this.state.tag.prefix+i2)):(this.input.set.call(this,i2),this.setRangeAtStartEnd(!1,this.DOM.input)),this.input.autocomplete.suggest.call(this),this.dropdown.hide(),!0)}}},getTagIdx(t2){return this.value.findIndex(e2=>e2.__tagId==(t2||{}).__tagId)},getNodeIndex(t2){var e2=0;if(t2)for(;t2=t2.previousElementSibling;)e2++;return e2},getTagElms(){for(var t2=arguments.length,e2=new Array(t2),i2=0;i2<t2;i2++)e2[i2]=arguments[i2];var s2="."+[...this.settings.classNames.tag.split(" "),...e2].join(".");return[].slice.call(this.DOM.scope.querySelectorAll(s2))},getLastTag(){var t2=this.DOM.scope.querySelectorAll(`${this.settings.classNames.tagSelector}:not(.${this.settings.classNames.tagHide}):not([readonly])`);return t2[t2.length-1]},isTagDuplicate(t2,e2,i2){var a2=0;if(this.settings.mode=="select")return!1;for(let n2 of this.value)s(this.trim(""+t2),n2.value,e2)&&i2!=n2.__tagId&&a2++;return a2},getTagIndexByValue(t2){var e2=[];return this.getTagElms().forEach((i2,a2)=>{s(this.trim(i2.textContent),t2,this.settings.dropdown.caseSensitive)&&e2.push(a2)}),e2},getTagElmByValue(t2){var e2=this.getTagIndexByValue(t2)[0];return this.getTagElms()[e2]},flashTag(t2){t2&&(t2.classList.add(this.settings.classNames.tagFlash),setTimeout(()=>{t2.classList.remove(this.settings.classNames.tagFlash)},100))},isTagBlacklisted(t2){return t2=this.trim(t2.toLowerCase()),this.settings.blacklist.filter(e2=>(""+e2).toLowerCase()==t2).length},isTagWhitelisted(t2){return!!this.getWhitelistItem(t2)},getWhitelistItem(t2,e2,i2){e2=e2||"value";var a2,n2=this.settings;return(i2=i2||n2.whitelist).some(i3=>{var o2=typeof i3=="string"?i3:i3[e2]||i3.value;if(s(o2,t2,n2.dropdown.caseSensitive,n2.trim))return a2=typeof i3=="string"?{value:i3}:i3,!0}),a2||e2!="value"||n2.tagTextProp=="value"||(a2=this.getWhitelistItem(t2,n2.tagTextProp,i2)),a2},validateTag(t2){var e2=this.settings,i2="value"in t2?"value":e2.tagTextProp,s2=this.trim(t2[i2]+"");return(t2[i2]+"").trim()?e2.pattern&&e2.pattern instanceof RegExp&&!e2.pattern.test(s2)?this.TEXTS.pattern:!e2.duplicates&&this.isTagDuplicate(s2,e2.dropdown.caseSensitive,t2.__tagId)?this.TEXTS.duplicate:this.isTagBlacklisted(s2)||e2.enforceWhitelist&&!this.isTagWhitelisted(s2)?this.TEXTS.notAllowed:!e2.validate||e2.validate(t2):this.TEXTS.empty},getInvalidTagAttrs(t2,e2){return{"aria-invalid":!0,class:`${t2.class||""} ${this.settings.classNames.tagNotAllowed}`.trim(),title:e2}},hasMaxTags(){return this.value.length>=this.settings.maxTags&&this.TEXTS.exceed},setReadonly(t2,e2){var i2=this.settings;document.activeElement.blur(),i2[e2||"readonly"]=t2,this.DOM.scope[(t2?"set":"remove")+"Attribute"](e2||"readonly",!0),this.setContentEditable(!t2)},setContentEditable(t2){this.settings.userInput&&(this.DOM.input.contentEditable=t2,this.DOM.input.tabIndex=t2?0:-1)},setDisabled(t2){this.setReadonly(t2,"disabled")},normalizeTags(t2){var e2=this.settings,i2=e2.whitelist,s2=e2.delimiters,a2=e2.mode,n2=e2.tagTextProp,o2=[],r2=!!i2&&i2[0]instanceof Object,l2=Array.isArray(t2),d2=l2&&t2[0].value,h2=t3=>(t3+"").split(s2).filter(t4=>t4).map(t4=>({[n2]:this.trim(t4),value:this.trim(t4)}));if(typeof t2=="number"&&(t2=t2.toString()),typeof t2=="string"){if(!t2.trim())return[];t2=h2(t2)}else l2&&(t2=[].concat(...t2.map(t3=>t3.value!=null?t3:h2(t3))));return r2&&!d2&&(t2.forEach(t3=>{var e3=o2.map(t4=>t4.value),i3=this.dropdown.filterListItems.call(this,t3[n2],{exact:!0});this.settings.duplicates||(i3=i3.filter(t4=>!e3.includes(t4.value)));var s3=i3.length>1?this.getWhitelistItem(t3[n2],n2,i3):i3[0];s3&&s3 instanceof Object?o2.push(s3):a2!="mix"&&(t3.value==null&&(t3.value=t3[n2]),o2.push(t3))}),o2.length&&(t2=o2)),t2},parseMixTags(t2){var e2=this.settings,i2=e2.mixTagsInterpolator,s2=e2.duplicates,a2=e2.transformTag,n2=e2.enforceWhitelist,o2=e2.maxTags,r2=e2.tagTextProp,l2=[];return t2=t2.split(i2[0]).map((t3,e3)=>{var d2,h2,g2,p2=t3.split(i2[1]),c2=p2[0],u2=l2.length==o2;try{if(c2==+c2)throw Error;h2=JSON.parse(c2)}catch{h2=this.normalizeTags(c2)[0]||{value:c2}}if(a2.call(this,h2),u2||!(p2.length>1)||n2&&!this.isTagWhitelisted(h2.value)||!s2&&this.isTagDuplicate(h2.value)){if(t3)return e3?i2[0]+t3:t3}else h2[d2=h2[r2]?r2:"value"]=this.trim(h2[d2]),g2=this.createTagElem(h2),l2.push(h2),g2.classList.add(this.settings.classNames.tagNoAnimation),p2[0]=g2.outerHTML,this.value.push(h2);return p2.join("")}).join(""),this.DOM.input.innerHTML=t2,this.DOM.input.appendChild(document.createTextNode("")),this.DOM.input.normalize(),this.getTagElms().forEach((t3,e3)=>T(t3,l2[e3])),this.update({withoutChangeEvent:!0}),t2},replaceTextWithNode(t2,e2){if(this.state.tag||e2){e2=e2||this.state.tag.prefix+this.state.tag.value;var i2,s2,a2=this.state.selection||window.getSelection(),n2=a2.anchorNode,o2=this.state.tag.delimiters?this.state.tag.delimiters.length:0;return n2.splitText(a2.anchorOffset-o2),(i2=n2.nodeValue.lastIndexOf(e2))==-1||(s2=n2.splitText(i2),t2&&n2.parentNode.replaceChild(t2,s2)),!0}},selectTag(t2,e2){var i2=this.settings;if(!i2.enforceWhitelist||this.isTagWhitelisted(e2.value)){this.input.set.call(this,e2[i2.tagTextProp]||e2.value,!0),this.state.actions.selectOption&&setTimeout(()=>this.setRangeAtStartEnd(!1,this.DOM.input));var s2=this.getLastTag();return s2?this.replaceTag(s2,e2):this.appendTag(t2),this.value[0]=e2,this.update(),this.trigger("add",{tag:t2,data:e2}),[t2]}},addEmptyTag(t2){var e2=g({value:""},t2||{}),i2=this.createTagElem(e2);T(i2,e2),this.appendTag(i2),this.editTag(i2,{skipValidation:!0})},addTags(t2,e2,i2){var s2=[],a2=this.settings,n2=[],o2=document.createDocumentFragment();if(i2=i2||a2.skipInvalid,!t2||t2.length==0)return s2;switch(t2=this.normalizeTags(t2),a2.mode){case"mix":return this.addMixTags(t2);case"select":e2=!1,this.removeAllTags()}return this.DOM.input.removeAttribute("style"),t2.forEach(t3=>{var e3,r2={},l2=Object.assign({},t3,{value:t3.value+""});if(t3=Object.assign({},l2),a2.transformTag.call(this,t3),t3.__isValid=this.hasMaxTags()||this.validateTag(t3),t3.__isValid!==!0){if(i2)return;if(g(r2,this.getInvalidTagAttrs(t3,t3.__isValid),{__preInvalidData:l2}),t3.__isValid==this.TEXTS.duplicate&&this.flashTag(this.getTagElmByValue(t3.value)),!a2.createInvalidTags)return void n2.push(t3.value)}if("readonly"in t3&&(t3.readonly?r2["aria-readonly"]=!0:delete t3.readonly),e3=this.createTagElem(t3,r2),s2.push(e3),a2.mode=="select")return this.selectTag(e3,t3);o2.appendChild(e3),t3.__isValid&&t3.__isValid===!0?(this.value.push(t3),this.trigger("add",{tag:e3,index:this.value.length-1,data:t3})):(this.trigger("invalid",{data:t3,index:this.value.length,tag:e3,message:t3.__isValid}),a2.keepInvalidTags||setTimeout(()=>this.removeTags(e3,!0),1e3)),this.dropdown.position()}),this.appendTag(o2),this.update(),t2.length&&e2&&(this.input.set.call(this,a2.createInvalidTags?"":n2.join(a2._delimiters)),this.setRangeAtStartEnd(!1,this.DOM.input)),a2.dropdown.enabled&&this.dropdown.refilter(),s2},addMixTags(t2){if((t2=this.normalizeTags(t2))[0].prefix||this.state.tag)return this.prefixedTextToTag(t2[0]);var e2=document.createDocumentFragment();return t2.forEach(t3=>{var i2=this.createTagElem(t3);e2.appendChild(i2)}),this.appendMixTags(e2),e2},appendMixTags(t2){var e2=!!this.state.selection;e2?this.injectAtCaret(t2):(this.DOM.input.focus(),(e2=this.setStateSelection()).range.setStart(this.DOM.input,e2.range.endOffset),e2.range.setEnd(this.DOM.input,e2.range.endOffset),this.DOM.input.appendChild(t2),this.updateValueByDOMTags(),this.update())},prefixedTextToTag(t2){var e2,i2=this.settings,s2=this.state.tag.delimiters;if(i2.transformTag.call(this,t2),t2.prefix=t2.prefix||this.state.tag?this.state.tag.prefix:(i2.pattern.source||i2.pattern)[0],e2=this.createTagElem(t2),this.replaceTextWithNode(e2)||this.DOM.input.appendChild(e2),setTimeout(()=>e2.classList.add(this.settings.classNames.tagNoAnimation),300),this.value.push(t2),this.update(),!s2){var a2=this.insertAfterTag(e2)||e2;setTimeout(this.placeCaretAfterNode,0,a2)}return this.state.tag=null,this.trigger("add",g({},{tag:e2},{data:t2})),e2},appendTag(t2){var e2=this.DOM,i2=e2.input;e2.scope.insertBefore(t2,i2)},createTagElem(t2,i2){t2.__tagId=m();var s2,a2=g({},t2,e({value:d(t2.value+"")},i2));return function(t3){for(var e2,i3=document.createNodeIterator(t3,NodeFilter.SHOW_TEXT,null,!1);e2=i3.nextNode();)e2.textContent.trim()||e2.parentNode.removeChild(e2)}(s2=this.parseTemplate("tag",[a2,this])),T(s2,t2),s2},reCheckInvalidTags(){var t2=this.settings;this.getTagElms(t2.classNames.tagNotAllowed).forEach((e2,i2)=>{var s2=T(e2),a2=this.hasMaxTags(),n2=this.validateTag(s2),o2=n2===!0&&!a2;if(t2.mode=="select"&&this.toggleScopeValidation(n2),o2)return s2=s2.__preInvalidData?s2.__preInvalidData:{value:s2.value},this.replaceTag(e2,s2);e2.title=a2||n2})},removeTags(t2,e2,i2){var s2,a2=this.settings;if(t2=t2&&t2 instanceof HTMLElement?[t2]:t2 instanceof Array?t2:t2?[t2]:[this.getLastTag()],s2=t2.reduce((t3,e3)=>{e3&&typeof e3=="string"&&(e3=this.getTagElmByValue(e3));var i3=T(e3);return e3&&i3&&!i3.readonly&&t3.push({node:e3,idx:this.getTagIdx(i3),data:T(e3,{__removed:!0})}),t3},[]),i2=typeof i2=="number"?i2:this.CSSVars.tagHideTransition,a2.mode=="select"&&(i2=0,this.input.set.call(this)),s2.length==1&&a2.mode!="select"&&s2[0].node.classList.contains(a2.classNames.tagNotAllowed)&&(e2=!0),s2.length)return a2.hooks.beforeRemoveTag(s2,{tagify:this}).then(()=>{function t3(t4){t4.node.parentNode&&(t4.node.parentNode.removeChild(t4.node),e2?a2.keepInvalidTags&&this.trigger("remove",{tag:t4.node,index:t4.idx}):(this.trigger("remove",{tag:t4.node,index:t4.idx,data:t4.data}),this.dropdown.refilter(),this.dropdown.position(),this.DOM.input.normalize(),a2.keepInvalidTags&&this.reCheckInvalidTags()))}i2&&i2>10&&s2.length==1?(function(e3){e3.node.style.width=parseFloat(window.getComputedStyle(e3.node).width)+"px",document.body.clientTop,e3.node.classList.add(a2.classNames.tagHide),setTimeout(t3.bind(this),i2,e3)}).call(this,s2[0]):s2.forEach(t3.bind(this)),e2||(this.removeTagsFromValue(s2.map(t4=>t4.node)),this.update(),a2.mode=="select"&&this.setContentEditable(!0))}).catch(t3=>{})},removeTagsFromDOM(){[].slice.call(this.getTagElms()).forEach(t2=>t2.parentNode.removeChild(t2))},removeTagsFromValue(t2){(t2=Array.isArray(t2)?t2:[t2]).forEach(t3=>{var e2=T(t3),i2=this.getTagIdx(e2);i2>-1&&this.value.splice(i2,1)})},removeAllTags(t2){t2=t2||{},this.value=[],this.settings.mode=="mix"?this.DOM.input.innerHTML="":this.removeTagsFromDOM(),this.dropdown.refilter(),this.dropdown.position(),this.state.dropdown.visible&&setTimeout(()=>{this.DOM.input.focus()}),this.settings.mode=="select"&&(this.input.set.call(this),this.setContentEditable(!0)),this.update(t2)},postUpdate(){var _a,_b;this.state.blockChangeEvent=!1;var t2=this.settings,e2=t2.classNames,i2=t2.mode=="mix"?t2.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value.trim():this.value.length+this.input.raw.call(this).length;this.toggleClass(e2.hasMaxTags,this.value.length>=t2.maxTags),this.toggleClass(e2.hasNoTags,!this.value.length),this.toggleClass(e2.empty,!i2),t2.mode=="select"&&this.toggleScopeValidation((_b=(_a=this.value)==null?void 0:_a[0])==null?void 0:_b.__isValid)},setOriginalInputValue(t2){var e2=this.DOM.originalInput;this.settings.mixMode.integrated||(e2.value=t2,e2.tagifyValue=e2.value,this.setPersistedData(t2,"value"))},update(t2){clearTimeout(this.debouncedUpdateTimeout),this.debouncedUpdateTimeout=setTimeout((function(){var e2=this.getInputValue();this.setOriginalInputValue(e2),this.settings.onChangeAfterBlur&&(t2||{}).withoutChangeEvent||this.state.blockChangeEvent||this.triggerChangeEvent(),this.postUpdate()}).bind(this),100)},getInputValue(){var t2=this.getCleanValue();return this.settings.mode=="mix"?this.getMixedTagsAsString(t2):t2.length?this.settings.originalInputValueFormat?this.settings.originalInputValueFormat(t2):JSON.stringify(t2):""},getCleanValue(t2){return a(t2||this.value,this.dataProps)},getMixedTagsAsString(){var t2="",e2=this,i2=this.settings,s2=i2.originalInputValueFormat||JSON.stringify,a2=i2.mixTagsInterpolator;return function i3(o2){o2.childNodes.forEach(o3=>{if(o3.nodeType==1){const r2=T(o3);if(o3.tagName=="BR"&&(t2+=`\r
`),r2&&v.call(e2,o3)){if(r2.__removed)return;t2+=a2[0]+s2(n(r2,e2.dataProps))+a2[1]}else o3.getAttribute("style")||["B","I","U"].includes(o3.tagName)?t2+=o3.textContent:o3.tagName!="DIV"&&o3.tagName!="P"||(t2+=`\r
`,i3(o3))}else t2+=o3.textContent})}(this.DOM.input),t2}},N.prototype.removeTag=N.prototype.removeTags,N})})(tagify_min);var tagify_minExports=tagify_min.exports;const Tagify=getDefaultExportFromCjs(tagify_minExports);class TagsElement{constructor(id,...tags){this.element=document.getElementById(id),this.tags=tags,new Tagify(this.element,{whitelist:this.tags,originalInputValueFormat:value=>value.map(item=>item.value).join(", ").trim()})}}export{TagsElement as default};
